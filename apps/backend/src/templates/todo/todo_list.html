{% extends "base.html" %}

{% block title %}Todo List - Django Version{% endblock %}

{% block content %}
<div class="font-sans max-w-7xl mx-auto p-8 leading-relaxed text-gray-800">
  <!-- Header -->
  <div class="mb-8">
    <h1 class="text-3xl font-bold text-gray-900 mb-2">Todo App (Django Version)</h1>
    <p class="text-gray-600">Read-only todo list demonstrating shared state using Tailwind CSS</p>
    <div class="mt-4 text-sm text-blue-600">
      <a href="/todos" class="hover:underline">â†’ View Interactive React Version</a>
    </div>
  </div>

  <!-- Stats -->
  <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-8">
    <div class="bg-white p-4 rounded-lg shadow-sm border">
      <div class="text-2xl font-bold text-blue-600">{{ stats.total }}</div>
      <div class="text-sm text-gray-600">Total</div>
    </div>
    <div class="bg-white p-4 rounded-lg shadow-sm border">
      <div class="text-2xl font-bold text-green-600">{{ stats.completed }}</div>
      <div class="text-sm text-gray-600">Completed</div>
    </div>
    <div class="bg-white p-4 rounded-lg shadow-sm border">
      <div class="text-2xl font-bold text-orange-600">{{ stats.incomplete }}</div>
      <div class="text-sm text-gray-600">Active</div>
    </div>
    <div class="bg-white p-4 rounded-lg shadow-sm border">
      <div class="text-2xl font-bold text-red-600">{{ stats.overdue }}</div>
      <div class="text-sm text-gray-600">Overdue</div>
    </div>
    <div class="bg-white p-4 rounded-lg shadow-sm border">
      <div class="text-xs space-y-1">
        <div class="flex justify-between">
          <span>High:</span>
          <span class="font-medium">{{ stats.by_priority.high }}</span>
        </div>
        <div class="flex justify-between">
          <span>Med:</span>
          <span class="font-medium">{{ stats.by_priority.medium }}</span>
        </div>
        <div class="flex justify-between">
          <span>Low:</span>
          <span class="font-medium">{{ stats.by_priority.low }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Filters -->
  <div class="flex flex-wrap gap-4 mb-6">
    <div class="flex gap-2">
      <a href="?{% if current_filter.priority != 'all' %}priority={{ current_filter.priority }}{% endif %}" 
         class="px-4 py-2 rounded-lg transition-colors {% if not current_filter.completed %}bg-blue-500 text-white{% else %}bg-gray-100 text-gray-700 hover:bg-gray-200{% endif %}">
        All
      </a>
      <a href="?completed=false{% if current_filter.priority != 'all' %}&priority={{ current_filter.priority }}{% endif %}" 
         class="px-4 py-2 rounded-lg transition-colors {% if current_filter.completed == 'false' %}bg-blue-500 text-white{% else %}bg-gray-100 text-gray-700 hover:bg-gray-200{% endif %}">
        Active
      </a>
      <a href="?completed=true{% if current_filter.priority != 'all' %}&priority={{ current_filter.priority }}{% endif %}" 
         class="px-4 py-2 rounded-lg transition-colors {% if current_filter.completed == 'true' %}bg-blue-500 text-white{% else %}bg-gray-100 text-gray-700 hover:bg-gray-200{% endif %}">
        Completed
      </a>
    </div>

    <div class="flex gap-2">
      <a href="?{% if current_filter.completed %}completed={{ current_filter.completed }}{% endif %}" 
         class="px-3 py-2 rounded-lg text-sm transition-colors {% if current_filter.priority == 'all' %}bg-gray-800 text-white{% else %}bg-gray-100 text-gray-700 hover:bg-gray-200{% endif %}">
        All Priorities
      </a>
      {% for priority in priorities %}
      <a href="?priority={{ priority }}{% if current_filter.completed %}&completed={{ current_filter.completed }}{% endif %}" 
         class="px-3 py-2 rounded-lg text-sm capitalize transition-colors {% if current_filter.priority == priority %}bg-gray-800 text-white{% else %}bg-gray-100 text-gray-700 hover:bg-gray-200{% endif %}">
        {{ priority }} priority
      </a>
      {% endfor %}
    </div>
  </div>

  <!-- Todo Columns -->
  <div class="grid md:grid-cols-2 gap-8">
    <!-- Active Todos -->
    <div>
      <h2 class="text-xl font-semibold mb-4 text-gray-800">
        Active ({{ active_todos|length }})
      </h2>
      <div class="space-y-3 min-h-32 p-4 bg-gray-50 rounded-lg">
        {% for todo in active_todos %}
        <div class="p-4 bg-white border-l-4 rounded-lg shadow-sm 
                    {% if todo.priority == 'high' %}border-l-red-500
                    {% elif todo.priority == 'medium' %}border-l-yellow-500
                    {% else %}border-l-blue-500{% endif %}">
          <div class="flex items-start justify-between gap-3">
            <div class="flex items-start gap-3 flex-1">
              <div class="mt-1 w-5 h-5 rounded-full border-2 border-gray-300 flex items-center justify-center">
                <!-- Empty circle for incomplete todos -->
              </div>
              
              <div class="flex-1">
                <h3 class="font-medium text-gray-900">{{ todo.title }}</h3>
                {% if todo.description %}
                <p class="text-sm text-gray-600 mt-1">{{ todo.description }}</p>
                {% endif %}
                
                <div class="flex items-center gap-2 mt-2 text-xs text-gray-500">
                  <span class="px-2 py-1 rounded-full text-xs font-medium
                               {% if todo.priority == 'high' %}bg-red-100 text-red-800
                               {% elif todo.priority == 'medium' %}bg-yellow-100 text-yellow-800
                               {% else %}bg-blue-100 text-blue-800{% endif %}">
                    {{ todo.priority }}
                  </span>
                  {% if todo.is_overdue %}
                  <span class="px-2 py-1 bg-red-100 text-red-800 rounded-full">
                    Overdue
                  </span>
                  {% endif %}
                  <span>{{ todo.created_at|date:"M d, Y" }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
        {% empty %}
        <p class="text-gray-500 text-center py-8">No active todos</p>
        {% endfor %}
      </div>
    </div>

    <!-- Completed Todos -->
    <div>
      <h2 class="text-xl font-semibold mb-4 text-gray-800">
        Completed ({{ completed_todos|length }})
      </h2>
      <div class="space-y-3 min-h-32 p-4 bg-gray-50 rounded-lg">
        {% for todo in completed_todos %}
        <div class="p-4 bg-white border-l-4 rounded-lg shadow-sm opacity-60 line-through
                    {% if todo.priority == 'high' %}border-l-red-500
                    {% elif todo.priority == 'medium' %}border-l-yellow-500
                    {% else %}border-l-blue-500{% endif %}">
          <div class="flex items-start justify-between gap-3">
            <div class="flex items-start gap-3 flex-1">
              <div class="mt-1 w-5 h-5 rounded-full border-2 bg-green-500 border-green-500 flex items-center justify-center">
                <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                </svg>
              </div>
              
              <div class="flex-1">
                <h3 class="font-medium text-gray-900">{{ todo.title }}</h3>
                {% if todo.description %}
                <p class="text-sm text-gray-600 mt-1">{{ todo.description }}</p>
                {% endif %}
                
                <div class="flex items-center gap-2 mt-2 text-xs text-gray-500">
                  <span class="px-2 py-1 rounded-full text-xs font-medium
                               {% if todo.priority == 'high' %}bg-red-100 text-red-800
                               {% elif todo.priority == 'medium' %}bg-yellow-100 text-yellow-800
                               {% else %}bg-blue-100 text-blue-800{% endif %}">
                    {{ todo.priority }}
                  </span>
                  <span>{{ todo.created_at|date:"M d, Y" }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
        {% empty %}
        <p class="text-gray-500 text-center py-8">No completed todos</p>
        {% endfor %}
      </div>
    </div>
  </div>

  <!-- Note about functionality -->
  <div class="mt-8 p-4 bg-blue-50 border border-blue-200 rounded-lg">
    <h3 class="font-semibold text-blue-900 mb-2">ðŸ“– About this version</h3>
    <p class="text-blue-800 text-sm">
      This is a read-only Django template version of the todo app. It demonstrates how the same data 
      and styling (using Tailwind CSS) can be shared across different frontend implementations. 
      For the full interactive experience with drag & drop, optimistic UI, and real-time updates, 
      check out the <a href="/todos" class="font-medium underline hover:no-underline">React version</a>.
    </p>
  </div>

  <!-- Refresh Button -->
  <div class="mt-8 text-center">
    <a href="{{ request.get_full_path }}" 
       class="inline-block px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors">
      Refresh
    </a>
  </div>
</div>
{% endblock %}